<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Secure Session</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-user-select: none; user-select: none; touch-action: manipulation; }

        body {
            background-color: #000;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            height: 100dvh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            color: #fff;
        }

        /* SPLASH SCREEN */
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 1000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            transition: opacity 0.8s ease;
        }

        .loader { width: 40px; height: 40px; border: 3px solid #333; border-top: 3px solid #0a84ff; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* HEADER */
        .header {
            padding: 55px 15px 15px; border-bottom: 0.5px solid #262626;
            background: rgba(18, 18, 18, 0.94); backdrop-filter: blur(20px);
            z-index: 100; display: flex; flex-direction: column; align-items: center;
            flex-shrink: 0;
        }
        .avatar { width: 45px; height: 45px; border-radius: 50%; background: #3a3a3c url('adrian.jpg') center/cover; margin-bottom: 4px; border: 1px solid #333; }
        .name { font-size: 11px; opacity: 0.6; }

        /* CHAT AREA - ADJUSTED FOR FULL VISIBILITY */
        .chat-container {
            flex: 1; 
            padding: 20px 12px 40px; 
            overflow-y: auto; 
            display: flex; 
            flex-direction: column; 
            gap: 8px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        .bubble { max-width: 80%; padding: 12px 16px; border-radius: 20px; font-size: 16px; line-height: 1.4; animation: bubbleSlide 0.3s ease-out; position: relative; flex-shrink: 0; }
        @keyframes bubbleSlide { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .received { align-self: flex-start; background-color: #262629; color: #fff; border-bottom-left-radius: 4px; }
        .sent { align-self: flex-end; background-color: #007aff; color: #fff; border-bottom-right-radius: 4px; }

        .typing { align-self: flex-start; background-color: #262629; padding: 12px 16px; border-radius: 20px; display: none; margin-bottom: 10px; }
        .dot { display: inline-block; width: 6px; height: 6px; background: #8e8e93; border-radius: 50%; margin-right: 3px; animation: wave 1.3s linear infinite; }
        @keyframes wave { 0%, 60%, 100% { transform: translateY(0); } 30% { transform: translateY(-5px); } }

        /* CHOICE BUTTONS */
        .choice-box { width: 100%; padding: 15px env(safe-area-inset-bottom); display: flex; flex-direction: column; gap: 10px; z-index: 200; background: #000; flex-shrink: 0; }
        .choice-btn { background: rgba(44, 44, 46, 0.98); color: #0a84ff; padding: 16px; border-radius: 14px; text-align: center; font-size: 15px; font-weight: 600; border: 0.5px solid #3a3a3c; }

        /* THE GIFT CARD - CRITICAL FIX */
        .gift-card { 
            align-self: center; /* Center it so it doesn't hug the left */
            width: 100%;
            max-width: 280px; 
            background: #1c1c1e; 
            border: 2px solid #0a84ff; 
            border-radius: 20px; 
            margin: 20px 0; 
            overflow: hidden; 
            display: none; 
            flex-shrink: 0; /* Prevents the browser from squishing it */
            animation: pulse-glow 2s infinite ease-in-out;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 5px rgba(10, 132, 255, 0.2); }
            50% { box-shadow: 0 0 25px rgba(10, 132, 255, 0.6); }
        }

        .gift-img { height: 120px; background: #1b5e20; display: flex; align-items: center; justify-content: center; font-size: 50px; }
        .gift-info { padding: 20px; background: #2c2c2e; display: flex; flex-direction: column; gap: 12px; }
        .gift-info h4 { font-size: 15px; font-weight: 600; text-align: center; }
        .dl-btn { background: #007aff; color: white; text-align: center; padding: 14px; border-radius: 12px; font-size: 14px; font-weight: 800; cursor: pointer; text-transform: uppercase; }

        #white-out { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; opacity: 0; z-index: 1000; pointer-events: none; transition: opacity 0.6s ease; }
    </style>
</head>
<body>

<div id="splash">
    <div class="loader"></div>
    <div id="status-text">Connecting to Server...</div>
</div>

<div id="white-out"></div>

<div class="header">
    <div class="avatar"></div>
    <div class="name">Adrian ></div>
</div>

<div class="chat-container" id="chat">
    <div id="typing-indicator" class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
</div>

<div class="choice-box" id="options"></div>

<script>
    const chat = document.getElementById('chat');
    const typing = document.getElementById('typing-indicator');
    const options = document.getElementById('options');
    const splash = document.getElementById('splash');
    const statusText = document.getElementById('status-text');

    window.onload = () => {
        setTimeout(() => { statusText.innerText = "Verifying Handshake..."; }, 1000);
        setTimeout(() => { statusText.innerText = "Access Granted."; }, 2000);
        setTimeout(() => { 
            splash.style.opacity = '0';
            setTimeout(() => { splash.style.display = 'none'; showPath('start'); }, 800);
        }, 2800);
    };

    const flow = {
        start: {
            msgs: ["Yo! Merry Christmas, Yxzanie! üéâ", "How's your day going so far?"],
            choices: [
                { text: "Merry Christmas! It's good, just chilling. Hbu?", next: 'chill' },
                { text: "Merry Christmas! Pretty busy but fun. What's up?", next: 'busy' }
            ]
        },
        chill: {
            msgs: ["Nice, the best kind of holiday honestly.", "I've just been stuck with family stuff all morning.", "But I finally finished that project I was telling you about."],
            choices: [{ text: "The coding thing you were working on?", next: 'project' }]
        },
        busy: {
            msgs: ["Haha I feel that! Holidays can be chaotic.", "Glad it's the fun kind of busy though.", "I've been hiding in my room trying to finish this one thing lol."],
            choices: [{ text: "Wait, the project you mentioned before?", next: 'project' }]
        },
        project: {
            msgs: ["Yeah! I decided to turn it into a Christmas thing for you.", "It's not a physical gift, but it's much cooler.", "Took me a while to get the security right."],
            choices: [
                { text: "Security? Should I be worried? üòÇ", next: 'secure' },
                { text: "You're getting me hyped, let's see it!", next: 'ready' }
            ]
        },
        secure: {
            msgs: ["Haha no, it's just meant for you only.", "I don't want anyone else hacking into the server I set up.", "Ready to try it?"],
            choices: [{ text: "Okay, let's do this! Send it.", next: 'gift_launch' }]
        },
        ready: {
            msgs: ["Alright! It's a bit technical, so don't get confused.", "It's stored in an encrypted package.", "Launching now..."],
            choices: [{ text: "Bring it on! I'm ready.", next: 'gift_launch' }]
        }
    };

    function addBubble(text, side) {
        const b = document.createElement('div');
        b.className = `bubble ${side}`;
        b.innerText = text;
        chat.insertBefore(b, typing);
        // Force the chat to scroll to the newest message
        chat.scrollTop = chat.scrollHeight;
    }

    async function showPath(key) {
        if (key === 'gift_launch') { createGift(); return; }
        const data = flow[key];
        for (let m of data.msgs) {
            typing.style.display = 'block';
            chat.appendChild(typing);
            chat.scrollTop = chat.scrollHeight;
            await new Promise(r => setTimeout(r, 1400));
            typing.style.display = 'none';
            addBubble(m, 'received');
        }
        options.innerHTML = '';
        data.choices.forEach(c => {
            const btn = document.createElement('div');
            btn.className = 'choice-btn';
            btn.innerText = c.text;
            btn.onclick = () => {
                addBubble(c.text, 'sent');
                options.innerHTML = '';
                setTimeout(() => showPath(c.next), 800);
            };
            options.appendChild(btn);
        });
    }

    function createGift() {
        typing.style.display = 'block';
        chat.appendChild(typing);
        chat.scrollTop = chat.scrollHeight;

        setTimeout(() => {
            typing.style.display = 'none';
            const card = document.createElement('div');
            card.className = 'gift-card';
            card.style.display = 'block';
            card.innerHTML = `
                <div class="gift-img">üéÅ</div>
                <div class="gift-info" id="g-status">
                    <h4>XMAS_SECURE_PKG.zip</h4>
                    <div class="dl-btn" onclick="startDownload(this.parentNode.parentNode)">OPEN GIFT</div>
                </div>
            `;
            chat.insertBefore(card, typing);
            
            // Fix: Force a scroll to make sure the card is perfectly centered
            setTimeout(() => {
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);

        }, 2000);
    }

    function startDownload(card) {
        card.style.animation = "none";
        const status = document.getElementById('g-status');
        status.innerHTML = `<h4>Downloading Assets...</h4><div style="width:100%;height:10px;background:#3a3a3c;border-radius:5px;overflow:hidden;"><div id="p-fill" style="width:0%;height:100%;background:#0a84ff;transition:width 0.3s;"></div></div><p id="p-text" style="font-size:12px;margin-top:8px;text-align:right;font-family:monospace;">0%</p>`;
        
        let p = 0;
        const inv = setInterval(() => {
            p += Math.floor(Math.random()*15)+5;
            if(p >= 100) {
                p=100; clearInterval(inv);
                status.innerHTML = "<h4>COMPLETE</h4><p style='font-size:12px;opacity:0.6;text-align:center;'>Redirecting to Terminal...</p>";
                setTimeout(() => { 
                    document.getElementById('white-out').style.opacity='1'; 
                    setTimeout(() => { window.location.href="https://yazu5.github.io/4t/"; }, 700); 
                }, 1200);
            }
            document.getElementById('p-fill').style.width = p+'%';
            document.getElementById('p-text').innerText = p+'%';
        }, 400);
    }

    document.addEventListener('contextmenu', e => e.preventDefault());
</script>
</body>
  </html>
  
